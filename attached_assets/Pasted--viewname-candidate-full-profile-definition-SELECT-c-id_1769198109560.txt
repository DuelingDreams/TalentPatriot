[
  {
    "viewname": "candidate_full_profile",
    "definition": " SELECT c.id,\n    c.org_id,\n    c.name,\n    c.email,\n    c.phone,\n    c.resume_url,\n    c.status,\n    c.created_by,\n    c.created_at,\n    c.updated_at,\n    c.resume_parsed,\n    c.skills,\n    c.experience_level,\n    c.total_years_experience,\n    c.education,\n    c.summary,\n    c.searchable_content,\n    c.linkedin_url,\n    c.portfolio_url,\n    c.work_authorization,\n    c.visa_sponsorship,\n    c.age_confirmation,\n    c.previous_employee,\n    c.referral_source,\n    c.employment_history,\n    c.comprehensive_education,\n    c.data_privacy_ack,\n    c.ai_acknowledgment,\n    c.gender,\n    c.race_ethnicity,\n    c.veteran_status,\n    c.disability_status,\n    am.education_details,\n    am.employment_details,\n    am.application_source,\n    am.form_version,\n    count(jc.id) AS total_applications\n   FROM ((candidates c\n     LEFT JOIN application_metadata am ON ((c.id = am.candidate_id)))\n     LEFT JOIN job_candidate jc ON ((c.id = jc.candidate_id)))\n  GROUP BY c.id, am.id;"
  },
  {
    "viewname": "public_jobs",
    "definition": " SELECT id,\n    org_id,\n    public_slug,\n    title,\n    description,\n    location,\n    department,\n    job_type,\n    status,\n    record_status,\n    experience_level,\n    remote_option,\n    salary_range,\n    created_at,\n    updated_at\n   FROM jobs j\n  WHERE ((is_public = true) AND ((record_status IS NULL) OR (record_status <> 'demo'::record_status)));"
  },
  {
    "viewname": "v_candidate_skills_summary",
    "definition": " SELECT id,\n    org_id,\n    name,\n    email,\n    experience_level,\n    total_years_experience,\n    COALESCE(array_length(skills, 1), 0) AS total_skills_count,\n    skills,\n    created_at,\n    updated_at\n   FROM candidates c\n  WHERE (status = 'active'::record_status);"
  },
  {
    "viewname": "v_dashboard_pipeline_snapshot",
    "definition": " SELECT j.id AS job_id,\n    j.title AS job_title,\n    j.org_id,\n    j.status AS job_status,\n    COALESCE(sum(\n        CASE\n            WHEN (c.stage = 'applied'::candidate_stage) THEN c.candidate_count\n            ELSE 0\n        END), (0)::bigint) AS applied,\n    COALESCE(sum(\n        CASE\n            WHEN (c.stage = 'phone_screen'::candidate_stage) THEN c.candidate_count\n            ELSE 0\n        END), (0)::bigint) AS phone_screen,\n    COALESCE(sum(\n        CASE\n            WHEN (c.stage = 'interview'::candidate_stage) THEN c.candidate_count\n            ELSE 0\n        END), (0)::bigint) AS interview,\n    COALESCE(sum(\n        CASE\n            WHEN (c.stage = 'technical'::candidate_stage) THEN c.candidate_count\n            ELSE 0\n        END), (0)::bigint) AS technical,\n    COALESCE(sum(\n        CASE\n            WHEN (c.stage = 'final'::candidate_stage) THEN c.candidate_count\n            ELSE 0\n        END), (0)::bigint) AS final,\n    COALESCE(sum(\n        CASE\n            WHEN (c.stage = 'offer'::candidate_stage) THEN c.candidate_count\n            ELSE 0\n        END), (0)::bigint) AS offer,\n    COALESCE(sum(\n        CASE\n            WHEN (c.stage = 'hired'::candidate_stage) THEN c.candidate_count\n            ELSE 0\n        END), (0)::bigint) AS hired,\n    COALESCE(sum(\n        CASE\n            WHEN (c.stage = 'rejected'::candidate_stage) THEN c.candidate_count\n            ELSE 0\n        END), (0)::bigint) AS rejected,\n    COALESCE(sum(c.candidate_count), (0)::bigint) AS total_candidates,\n    j.created_at,\n    j.updated_at\n   FROM (jobs j\n     LEFT JOIN v_pipeline_stage_counts c ON ((c.job_id = j.id)))\n  GROUP BY j.id, j.title, j.org_id, j.status, j.created_at, j.updated_at\n  ORDER BY j.updated_at DESC;"
  },
  {
    "viewname": "v_job_health",
    "definition": " WITH last_activity AS (\n         SELECT job_pipeline_stage_events.job_id,\n            max(job_pipeline_stage_events.changed_at) FILTER (WHERE ((job_pipeline_stage_events.to_stage <> 'hired'::text) AND (job_pipeline_stage_events.to_stage <> 'rejected'::text))) AS last_active_move,\n            max(job_pipeline_stage_events.changed_at) AS last_any_move\n           FROM job_pipeline_stage_events\n          GROUP BY job_pipeline_stage_events.job_id\n        ), stage_counts AS (\n         SELECT v_pipeline_stage_counts.job_id,\n            sum(\n                CASE\n                    WHEN (v_pipeline_stage_counts.stage = 'applied'::candidate_stage) THEN v_pipeline_stage_counts.candidate_count\n                    ELSE 0\n                END) AS c_applied,\n            sum(\n                CASE\n                    WHEN (v_pipeline_stage_counts.stage = 'phone_screen'::candidate_stage) THEN v_pipeline_stage_counts.candidate_count\n                    ELSE 0\n                END) AS c_phone_screen,\n            sum(\n                CASE\n                    WHEN (v_pipeline_stage_counts.stage = 'interview'::candidate_stage) THEN v_pipeline_stage_counts.candidate_count\n                    ELSE 0\n                END) AS c_interview,\n            sum(\n                CASE\n                    WHEN (v_pipeline_stage_counts.stage = 'technical'::candidate_stage) THEN v_pipeline_stage_counts.candidate_count\n                    ELSE 0\n                END) AS c_technical,\n            sum(\n                CASE\n                    WHEN (v_pipeline_stage_counts.stage = 'final'::candidate_stage) THEN v_pipeline_stage_counts.candidate_count\n                    ELSE 0\n                END) AS c_final,\n            sum(\n                CASE\n                    WHEN (v_pipeline_stage_counts.stage = 'offer'::candidate_stage) THEN v_pipeline_stage_counts.candidate_count\n                    ELSE 0\n                END) AS c_offer,\n            sum(\n                CASE\n                    WHEN (v_pipeline_stage_counts.stage = 'hired'::candidate_stage) THEN v_pipeline_stage_counts.candidate_count\n                    ELSE 0\n                END) AS c_hired,\n            sum(\n                CASE\n                    WHEN (v_pipeline_stage_counts.stage = 'rejected'::candidate_stage) THEN v_pipeline_stage_counts.candidate_count\n                    ELSE 0\n                END) AS c_rejected,\n            sum(v_pipeline_stage_counts.candidate_count) AS c_total\n           FROM v_pipeline_stage_counts\n          GROUP BY v_pipeline_stage_counts.job_id\n        )\n SELECT j.id AS job_id,\n    j.title,\n    j.org_id,\n    j.status AS job_status,\n    COALESCE(sc.c_applied, (0)::bigint) AS applied_count,\n    COALESCE(sc.c_phone_screen, (0)::bigint) AS phone_screen_count,\n    COALESCE(sc.c_interview, (0)::bigint) AS interview_count,\n    COALESCE(sc.c_technical, (0)::bigint) AS technical_count,\n    COALESCE(sc.c_final, (0)::bigint) AS final_count,\n    COALESCE(sc.c_offer, (0)::bigint) AS offer_count,\n    COALESCE(sc.c_hired, (0)::bigint) AS hired_count,\n    COALESCE(sc.c_rejected, (0)::bigint) AS rejected_count,\n    COALESCE(sc.c_total, (0)::bigint) AS total_candidates,\n        CASE\n            WHEN (j.status <> 'open'::job_status) THEN 'Closed'::text\n            WHEN ((la.last_active_move IS NULL) AND (COALESCE(sc.c_total, (0)::bigint) = 0)) THEN 'No Candidates'::text\n            WHEN (la.last_active_move IS NULL) THEN 'Needs Attention'::text\n            WHEN (la.last_active_move < (now() - '14 days'::interval)) THEN 'Stale'::text\n            WHEN ((((COALESCE(sc.c_interview, (0)::bigint) + COALESCE(sc.c_technical, (0)::bigint)) + COALESCE(sc.c_final, (0)::bigint)) = 0) AND ((COALESCE(sc.c_applied, (0)::bigint) + COALESCE(sc.c_phone_screen, (0)::bigint)) > 0) AND (la.last_any_move < (now() - '7 days'::interval))) THEN 'Needs Attention'::text\n            ELSE 'Healthy'::text\n        END AS health_status,\n    la.last_active_move,\n    la.last_any_move\n   FROM ((jobs j\n     LEFT JOIN last_activity la ON ((la.job_id = j.id)))\n     LEFT JOIN stage_counts sc ON ((sc.job_id = j.id)));"
  },
  {
    "viewname": "vw_client_performance",
    "definition": " SELECT org_id,\n    client_id,\n    client_name,\n    industry,\n    total_jobs,\n    active_jobs,\n    filled_jobs,\n    fill_rate,\n    avg_time_to_fill,\n    aging_jobs_30_days,\n    total_candidates,\n    candidates_hired\n   FROM mv_client_performance mv\n  WHERE (EXISTS ( SELECT 1\n           FROM user_organizations uo\n          WHERE ((uo.user_id = auth.uid()) AND (uo.org_id = mv.org_id))));"
  }
]