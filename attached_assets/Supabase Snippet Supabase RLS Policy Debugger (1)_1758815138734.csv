schemaname,tablename,policyname,cmd,qual,with_check,recursion_risk
public,candidates,Auth read candidates by org,SELECT,"(EXISTS ( SELECT 1
   FROM user_organizations uo
  WHERE ((uo.user_id = auth.uid()) AND (uo.org_id = candidates.org_id))))",null,POTENTIAL RECURSION RISK
public,organizations,Organization owners can update,UPDATE,"((auth.uid() = owner_id) OR (auth.uid() IN ( SELECT user_organizations.user_id
   FROM user_organizations
  WHERE ((user_organizations.org_id = organizations.id) AND (user_organizations.role = ANY (ARRAY['owner'::organization_role, 'admin'::organization_role]))))))",null,POTENTIAL RECURSION RISK
public,organizations,Users can view own organizations,SELECT,"((auth.uid() = owner_id) OR (auth.uid() IN ( SELECT user_organizations.user_id
   FROM user_organizations
  WHERE (user_organizations.org_id = organizations.id))))",null,POTENTIAL RECURSION RISK
public,organizations,Users can view their organizations,SELECT,"(is_platform_admin() OR (owner_id = auth.uid()) OR (EXISTS ( SELECT 1
   FROM user_organizations uo
  WHERE ((uo.org_id = organizations.id) AND (uo.user_id = auth.uid())))))",null,POTENTIAL RECURSION RISK
public,user_organizations,Organization owners can manage memberships,ALL,"((auth.uid() IN ( SELECT uo2.user_id
   FROM user_organizations uo2
  WHERE ((uo2.org_id = user_organizations.org_id) AND (uo2.role = ANY (ARRAY['owner'::organization_role, 'admin'::organization_role]))))) OR (auth.uid() = user_id))",null,POTENTIAL RECURSION RISK
public,user_organizations,Users can view their memberships,SELECT,"((auth.uid() = user_id) OR (auth.uid() IN ( SELECT organizations.owner_id
   FROM organizations
  WHERE (organizations.id = user_organizations.org_id))))",null,POTENTIAL RECURSION RISK
public,candidates,Users can manage candidates in their organizations,ALL,(is_authenticated() AND (org_id = ANY (get_user_org_ids(auth.uid()))) AND (get_user_role_safe(auth.uid()) <> 'demo_viewer'::text)),null,OK
public,candidates,Users can view candidates in their organizations,SELECT,(is_authenticated() AND ((org_id = ANY (get_user_org_ids(auth.uid()))) OR ((get_user_role_safe(auth.uid()) = 'demo_viewer'::text) AND (status = 'demo'::record_status)))),null,OK
public,candidates,block_anon_candidates,ALL,FALSE,null,OK
public,candidates,block_anon_candidates_delete,DELETE,FALSE,null,OK
public,candidates,block_anon_candidates_select,SELECT,FALSE,null,OK
public,candidates,block_anon_candidates_update,UPDATE,FALSE,null,OK
public,candidates,candidates_anon_insert_for_applications,INSERT,null,TRUE,OK
public,organizations,Authenticated users can create organizations,INSERT,null,(auth.uid() = owner_id),OK
public,organizations,Org admins can update organizations,UPDATE,(is_platform_admin() OR is_org_admin(id)),null,OK
public,organizations,Users can create organizations they own,INSERT,null,(auth.uid() = owner_id),OK
public,organizations,Users can view organizations they belong to,SELECT,(is_authenticated() AND (id = ANY (get_user_org_ids(auth.uid())))),null,OK
public,organizations,block_anon_organizations,ALL,FALSE,null,OK
public,user_organizations,Org admins can manage memberships,ALL,(is_platform_admin() OR is_org_admin(org_id)),null,OK
public,user_organizations,Users can create their membership,INSERT,null,"((auth.uid() = user_id) OR (auth.uid() IN ( SELECT organizations.owner_id
   FROM organizations
  WHERE (organizations.id = user_organizations.org_id))))",OK
public,user_organizations,Users can view own memberships,SELECT,(auth.uid() = user_id),null,OK
public,user_organizations,Users can view their org memberships,SELECT,(is_platform_admin() OR (user_id = auth.uid()) OR is_org_admin(org_id)),null,OK
public,user_organizations,Users can view their organization memberships,SELECT,(is_authenticated() AND ((user_id = auth.uid()) OR (org_id = ANY (get_user_org_ids(auth.uid()))))),null,OK
public,user_organizations,block_anon_user_organizations,ALL,FALSE,null,OK
public,user_organizations,user_organizations_block_anonymous,ALL,FALSE,null,OK
public,user_organizations,user_organizations_simple_policy,ALL,(user_id = auth.uid()),null,OK